<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Server Management - Mitchbot</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <!-- Navigation Bar -->
  <nav class="navbar">
    <div class="navbar__container">
      <div class="navbar__brand">
        ü§ñ Mitchbot
      </div>
      <div class="navbar__nav">
        <a href="/dashboard" class="navbar__link">Dashboard</a>
        <a href="/auth/logout" class="navbar__link">Logout</a>
      </div>
    </div>
  </nav>

  <!-- Toast Container -->
  <div class="toast-container" id="toast-container"></div>

  <!-- Main Container -->
  <div class="container">
    <!-- Server Header -->
    <div class="server-header">
      <div class="server-header__info">
        <h1 class="server-header__name" id="guild-name">Loading...</h1>
        <p class="server-header__meta">Configure moderation, logging, and bot features</p>
      </div>
    </div>

    <!-- Feature Health Overview -->
    <div class="health-overview" id="health-overview">
      <div class="health-overview__header">
        <h2 class="health-overview__title">
          ‚ö° Feature Health
        </h2>
        <button class="health-overview__toggle" id="health-toggle" aria-expanded="true" aria-controls="health-content">
          Collapse
        </button>
      </div>

      <div id="health-content">
        <!-- Health Summary Cards -->
        <div class="health-overview__cards">
          <div class="health-card health-card--active" id="health-card-active">
            <div class="health-card__icon">‚úì</div>
            <div class="health-card__count" id="health-count-active">0</div>
            <div class="health-card__label">Active</div>
          </div>

          <div class="health-card health-card--warning" id="health-card-warning">
            <div class="health-card__icon">‚ö†</div>
            <div class="health-card__count" id="health-count-warning">0</div>
            <div class="health-card__label">Needs Setup</div>
          </div>

          <div class="health-card health-card--inactive" id="health-card-inactive">
            <div class="health-card__icon">‚óã</div>
            <div class="health-card__count" id="health-count-inactive">0</div>
            <div class="health-card__label">Inactive</div>
          </div>
        </div>

        <!-- Detailed Health Sections -->
        <div id="health-details">
          <!-- Active Features -->
          <div class="health-section" id="health-active-section" style="display: none;">
            <h3 class="health-section__title">
              üü¢ Active Features
            </h3>
            <ul class="health-section__list" id="health-active-list"></ul>
          </div>

          <!-- Needs Attention -->
          <div class="health-section" id="health-warning-section" style="display: none;">
            <h3 class="health-section__title">
              üü° Needs Attention
            </h3>
            <ul class="health-section__list" id="health-warning-list"></ul>
          </div>

          <!-- Inactive Features -->
          <div class="health-section" id="health-inactive-section" style="display: none;">
            <h3 class="health-section__title">
              ‚ö™ Inactive
            </h3>
            <ul class="health-section__list" id="health-inactive-list"></ul>
          </div>
        </div>
      </div>
    </div>

    <!-- Automod Section -->
    <section id="section-automod">
      <div class="card card--inactive" id="card-automod">
        <div class="card__header">
          <div>
            <h3 class="card__title">
              <span class="card__icon">üõ°Ô∏è</span>
              Automod
            </h3>
            <p class="card__subtitle">Automated moderation system</p>
          </div>
          <span class="status-badge status-badge--inactive" id="badge-automod">
            <span class="status-badge__dot"></span>
            <span>Disabled</span>
          </span>
        </div>

        <p class="card__description">
          Enable automated moderation to protect your server from spam, inappropriate content, and policy violations.
        </p>

        <!-- Main Toggle -->
        <label class="toggle-container">
          <input type="checkbox" class="toggle-input" id="automod-enabled">
          <span class="toggle-track">
            <span class="toggle-knob"></span>
          </span>
          <span class="toggle-label">Enable Automod</span>
        </label>

        <div class="mt-6">
          <button class="btn btn-primary" onclick="saveAutomod()">Save Automod Settings</button>
        </div>
      </div>
    </section>

    <!-- Word Filter Section -->
    <section id="section-wordfilter">
      <div class="card card--inactive" id="card-wordfilter">
        <div class="card__header">
          <div>
            <h3 class="card__title">
              <span class="card__icon">üö´</span>
              Word Filter
            </h3>
            <p class="card__subtitle" id="wordfilter-subtitle">No words configured</p>
          </div>
          <span class="status-badge status-badge--inactive" id="badge-wordfilter">
            <span class="status-badge__dot"></span>
            <span>Disabled</span>
          </span>
        </div>

        <p class="card__description">
          Automatically removes messages containing blocked words or phrases to keep your server clean and welcoming.
        </p>

        <!-- Warning State (hidden by default) -->
        <div class="alert alert--warning" id="wordfilter-warning" style="display: none;">
          <span class="alert__icon">‚ö†</span>
          <div class="alert__content">
            <div class="alert__title">Needs Configuration</div>
            <div class="alert__message">Word filter is enabled but no words are configured. Add filtered words below.</div>
          </div>
        </div>

        <!-- Main Toggle -->
        <label class="toggle-container">
          <input type="checkbox" class="toggle-input" id="wordfilter-enabled">
          <span class="toggle-track">
            <span class="toggle-knob"></span>
          </span>
          <span class="toggle-label">Enable Word Filter</span>
        </label>

        <!-- Filtered Words -->
        <div class="form-group">
          <label class="form-label">Filtered Words</label>
          <p class="helper-text">
            <span class="helper-text__icon">‚ÑπÔ∏è</span>
            Messages containing these words will be automatically deleted and users will receive a warning.
          </p>
          <div class="tag-list" id="word-list"></div>
          <div class="tag-input-group">
            <input type="text" class="form-input" id="new-word" placeholder="Add a word or phrase...">
            <button class="btn btn-secondary" onclick="addWord()">Add Word</button>
          </div>
        </div>

        <!-- Progressive Disclosure -->
        <div class="disclosure" data-disclosure>
          <button class="disclosure__trigger" data-disclosure-trigger aria-expanded="false" aria-controls="wordfilter-advanced">
            <span>Show advanced options</span>
            <span class="disclosure__icon">‚ñº</span>
          </button>
          <div class="disclosure__content" data-disclosure-content id="wordfilter-advanced" hidden>
            <div class="disclosure__inner">
              <p class="text-muted mb-4">Additional word filter configuration options will be available here.</p>
            </div>
          </div>
        </div>

        <div class="mt-6">
          <button class="btn btn-primary" onclick="saveAutomod()">Save Changes</button>
        </div>
      </div>
    </section>

    <!-- Invite Filter Section -->
    <section id="section-invitefilter">
      <div class="card card--inactive" id="card-invitefilter">
        <div class="card__header">
          <div>
            <h3 class="card__title">
              <span class="card__icon">üîó</span>
              Invite Filter
            </h3>
            <p class="card__subtitle">Block Discord server invites</p>
          </div>
          <span class="status-badge status-badge--inactive" id="badge-invitefilter">
            <span class="status-badge__dot"></span>
            <span>Disabled</span>
          </span>
        </div>

        <p class="card__description">
          Blocks Discord server invites to prevent raid spam and unauthorized advertising in your community.
        </p>

        <!-- Main Toggle -->
        <label class="toggle-container">
          <input type="checkbox" class="toggle-input" id="invitefilter-enabled">
          <span class="toggle-track">
            <span class="toggle-knob"></span>
          </span>
          <span class="toggle-label">Block Server Invites</span>
        </label>

        <!-- Exception Settings -->
        <div class="form-group">
          <label class="form-label">Exceptions</label>
          <p class="helper-text">
            <span class="helper-text__icon">‚ÑπÔ∏è</span>
            Configure which invites are allowed even when the filter is active.
          </p>

          <label style="display: flex; align-items: center; gap: var(--space-2); margin-top: var(--space-3);">
            <input type="checkbox" id="allow-own-server">
            <span>Allow invites to this server</span>
          </label>
          <p class="helper-text" style="margin-left: var(--space-6);">
            Members can share your server's invite link to grow your community.
          </p>
        </div>

        <div class="mt-6">
          <button class="btn btn-primary" onclick="saveAutomod()">Save Changes</button>
        </div>
      </div>
    </section>

    <!-- Link Filter Section -->
    <section id="section-linkfilter">
      <div class="card card--inactive" id="card-linkfilter">
        <div class="card__header">
          <div>
            <h3 class="card__title">
              <span class="card__icon">üåê</span>
              Link Filter
            </h3>
            <p class="card__subtitle" id="linkfilter-subtitle">No domains configured</p>
          </div>
          <span class="status-badge status-badge--inactive" id="badge-linkfilter">
            <span class="status-badge__dot"></span>
            <span>Disabled</span>
          </span>
        </div>

        <p class="card__description">
          Control which links can be shared in your server using whitelists and blacklists.
        </p>

        <!-- Warning State (hidden by default) -->
        <div class="alert alert--warning" id="linkfilter-warning" style="display: none;">
          <span class="alert__icon">‚ö†</span>
          <div class="alert__content">
            <div class="alert__title">Needs Configuration</div>
            <div class="alert__message">Link filter is enabled but no domains are configured. Add whitelisted or blacklisted domains below.</div>
          </div>
        </div>

        <!-- Main Toggle -->
        <label class="toggle-container">
          <input type="checkbox" class="toggle-input" id="linkfilter-enabled">
          <span class="toggle-track">
            <span class="toggle-knob"></span>
          </span>
          <span class="toggle-label">Enable Link Filter</span>
        </label>

        <!-- Whitelisted Domains -->
        <div class="form-group">
          <label class="form-label">Whitelisted Domains</label>
          <p class="helper-text">
            <span class="helper-text__icon">‚ÑπÔ∏è</span>
            Links to these domains will always be allowed. Common choices: youtube.com, github.com, twitter.com
          </p>
          <div class="tag-list" id="whitelist"></div>
          <div class="tag-input-group">
            <input type="text" class="form-input" id="new-whitelist" placeholder="Add domain (e.g., youtube.com)...">
            <button class="btn btn-secondary" onclick="addWhitelist()">Add Domain</button>
          </div>
        </div>

        <!-- Blacklisted Domains -->
        <div class="form-group">
          <label class="form-label">Blacklisted Domains</label>
          <p class="helper-text">
            <span class="helper-text__icon">‚ÑπÔ∏è</span>
            Links to these domains will always be blocked, even if the link filter is disabled.
          </p>
          <div class="tag-list" id="blacklist"></div>
          <div class="tag-input-group">
            <input type="text" class="form-input" id="new-blacklist" placeholder="Add domain (e.g., spam.com)...">
            <button class="btn btn-secondary" onclick="addBlacklist()">Add Domain</button>
          </div>
        </div>

        <div class="mt-6">
          <button class="btn btn-primary" onclick="saveAutomod()">Save Changes</button>
        </div>
      </div>
    </section>

    <!-- Spam Detection Section -->
    <section id="section-spam">
      <div class="card card--inactive" id="card-spam">
        <div class="card__header">
          <div>
            <h3 class="card__title">
              <span class="card__icon">‚ö°</span>
              Spam Detection
            </h3>
            <p class="card__subtitle">Automatic spam protection</p>
          </div>
          <span class="status-badge status-badge--inactive" id="badge-spam">
            <span class="status-badge__dot"></span>
            <span>Disabled</span>
          </span>
        </div>

        <p class="card__description">
          Detects and blocks spam messages including repeated messages, excessive caps, and mention spam.
        </p>

        <!-- Main Toggle -->
        <label class="toggle-container">
          <input type="checkbox" class="toggle-input" id="spam-enabled">
          <span class="toggle-track">
            <span class="toggle-knob"></span>
          </span>
          <span class="toggle-label">Enable Spam Detection</span>
        </label>

        <div class="alert alert--info mt-4">
          <span class="alert__icon">‚ÑπÔ∏è</span>
          <div class="alert__content">
            <div class="alert__message">Spam detection monitors for duplicate messages, excessive caps lock, and mention spam.</div>
          </div>
        </div>

        <div class="mt-6">
          <button class="btn btn-primary" onclick="saveAutomod()">Save Changes</button>
        </div>
      </div>
    </section>

    <!-- Section Divider -->
    <hr class="section-divider">

    <!-- Moderation Logs Section -->
    <section id="section-logging">
      <div class="card card--inactive" id="card-logging">
        <div class="card__header">
          <div>
            <h3 class="card__title">
              <span class="card__icon">üìã</span>
              Moderation Logs
            </h3>
            <p class="card__subtitle">Track all moderation actions</p>
          </div>
          <span class="status-badge status-badge--inactive" id="badge-logging">
            <span class="status-badge__dot"></span>
            <span>Disabled</span>
          </span>
        </div>

        <p class="card__description">
          Log all moderation actions, automod violations, and administrative events to a designated channel.
        </p>

        <!-- Warning State (hidden by default) -->
        <div class="alert alert--warning" id="logging-warning" style="display: none;">
          <span class="alert__icon">‚ö†</span>
          <div class="alert__content">
            <div class="alert__title">No Channel Selected</div>
            <div class="alert__message">Select a channel below to enable moderation logging.</div>
          </div>
        </div>

        <!-- Log Channel Selection -->
        <div class="form-group">
          <label class="form-label">Moderation Log Channel</label>
          <p class="helper-text">
            <span class="helper-text__icon">‚ÑπÔ∏è</span>
            All automod actions, bans, kicks, and warnings will be logged to this channel.
          </p>
          <select class="form-select" id="log-channel">
            <option value="">None - Disable Logging</option>
          </select>
        </div>

        <div class="mt-6">
          <button class="btn btn-primary" onclick="saveSettings()">Save Logging Settings</button>
        </div>
      </div>
    </section>

    <!-- Recent Moderation Logs -->
    <section id="section-logs-view">
      <div class="card">
        <div class="card__header">
          <div>
            <h3 class="card__title">
              <span class="card__icon">üìú</span>
              Recent Moderation Actions
            </h3>
            <p class="card__subtitle">Last 25 moderation events</p>
          </div>
        </div>

        <div id="logs-container">
          <div class="loading">Loading moderation logs...</div>
        </div>
      </div>
    </section>

    <!-- Section Divider -->
    <hr class="section-divider">

    <!-- Birthdays Section -->
    <section id="section-birthdays">
      <div class="card">
        <div class="card__header">
          <div>
            <h3 class="card__title">
              <span class="card__icon">üéÇ</span>
              Birthday Notifications
            </h3>
            <p class="card__subtitle">Celebrate member birthdays</p>
          </div>
        </div>

        <p class="card__description">
          Automatically celebrate member birthdays with announcements and special roles.
        </p>

        <div id="birthdays-container">
          <div class="loading">Loading birthday data...</div>
        </div>
      </div>
    </section>
  </div>

  <script src="/js/guild.js"></script>
</body>
</html>
